{% extends "main.html" %}

{% block title %}{{page}} page{% endblock title %}

{% block contant %}

{% if messages %}
{% for message in messages %}
<div class="alert alert-success alert-dismissible fade show" role="alert">
  {{message}}
  <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{% endfor %}
{% endif %}

<form method="post" class="w-100 d-flex justify-content-center mt-4 px-3">
  {% csrf_token %}
  <div class="input-group" style="max-width: 450px;">
      <input type="text" class="form-control" name="task_name" placeholder="Enter new task..." required>
      <button type="submit" class="btn btn-dark" style="color:white; font-weight:500;">Add Task</button>
  </div>
</form>

<!-- TABLE -->
<div class="container mt-4 ">
  <div class="table-responsive d-none d-md-block">
    <table class="table table-bordered align-middle" style="word-break: break-word;">
      <thead class="premium-header">
        <tr>
          <th>#</th>
          <th class="text-start">Task name</th>
          <th>Status</th>
          <th>Edit</th>
          <th>Delete</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for t in all_task %}
        <tr class="text-center">
          <td>{{ forloop.counter }}</td>
          <td class="text-start fw-semibold {% if t.is_completed %}text-decoration-line-through text-success{% endif %}">
            {{ t.task_name }}
          </td>
          <td>
            {% if t.is_completed %}
            <span class="badge bg-success px-3 py-2">Done</span>
            {% else %}
            <span class="badge bg-warning text-dark px-3 py-2">Pending</span>
            {% endif %}
          </td>
          <td><a class="btn btn-outline-primary btn-sm w-100" href="{% url 'task_edit' t.id %}">Edit</a></td>
          <td><a class="btn btn-outline-danger btn-sm w-100" href="{% url 'task_delete' t.id %}">Delete</a></td>
          <td>
            {% if t.is_completed %}
            <a class="btn btn-secondary btn-sm w-100" href="{% url 'update_status' t.id %}">Mark Pending</a>
            {% else %}
            <a class="btn btn-success btn-sm w-100" href="{% url 'update_status' t.id %}">Mark Done</a>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<!-- Mobile view -->
<div class="table-responsive">
  <!-- MOBILE CARD VIEW (Visible only on small screens) -->
<div class="d-block d-md-none mt-4 px-3">
  {% for t in all_task %}
  <div class="card shadow-sm mb-3 border-0">
    <div class="card-body">

      <h5 class="fw-bold {% if t.is_completed %}text-decoration-line-through text-success{% endif %}">
        {{ t.task_name }}
      </h5>

      <p class="mb-1">
        <strong>Status:</strong>
        {% if t.is_completed %}
        <span class="badge bg-success">Done</span>
        {% else %}
        <span class="badge bg-warning text-dark">Pending</span>
        {% endif %}
      </p>

      <div class="d-flex flex-column gap-2 mt-2">
        <a class="btn btn-outline-primary btn-sm" href="{% url 'task_edit' t.id %}"> Edit Task</a>
        <a class="btn btn-outline-danger btn-sm" href="{% url 'task_delete' t.id %}"> Delete Task</a>

        {% if t.is_completed %}
        <a class="btn btn-secondary btn-sm" href="{% url 'update_status' t.id %}"> Mark Pending</a>
        {% else %}
        <a class="btn btn-success btn-sm" href="{% url 'update_status' t.id %}"> Mark Done</a>
        {% endif %}
      </div>
      
    </div>
  </div>
  {% endfor %}
</div>

</div>

<!-- PAGINATION -->
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center gap-2 flex-wrap mt-3">
    {% if all_task.has_previous %}
    <li class="page-item">
      <a class="page-link bg-dark text-white border-dark px-4 py-2 fw-semibold rounded-3"
         href="?page={{all_task.previous_page_number}}">&laquo; Prev</a>
    </li>
    {% endif %}
    <li class="page-item active">
      <a class="page-link bg-primary text-white border-primary px-4 py-2 fw-semibold rounded-3"
         href="#">Page {{all_task.number}}</a>
    </li>
    {% if all_task.has_next %}
    <li class="page-item">
      <a class="page-link bg-dark text-white border-dark px-4 py-2 fw-semibold rounded-3"
         href="?page={{all_task.next_page_number}}">Next &raquo;</a>
    </li>
    {% endif %}
  </ul>
</nav>


<style>
  /* Elegant Header (Muted Premium Look) */
  table thead.premium-header tr th {
    background: linear-gradient(90deg, #222831, #393E46) !important;
    color: #EEEEEE !important;
    text-transform: uppercase;
    font-weight: 600 !important;
    font-size: 16px !important;
    letter-spacing: 0.5px;
    padding-top: 16px !important;
    padding-bottom: 16px !important;
    border-bottom: none !important;
  }

  table.table {
    border-radius: 10px !important;
    box-shadow: 0px 0px 18px rgba(0, 0, 0, 0.10);
    overflow: hidden;
  }

  /* Softer row hover (no scale) */
  tbody tr {
    transition: background 0.20s ease-in-out;
  }
  tbody tr:hover {
    background: rgba(57, 62, 70, 0.08) !important; /* Light grey shadow */
  }
</style>


{% endblock contant %}
